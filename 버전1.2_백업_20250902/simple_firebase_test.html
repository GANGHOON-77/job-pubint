<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; font-weight: bold; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .job-item { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 5px; background: #fafafa; }
        .job-title { font-size: 18px; font-weight: bold; color: #333; margin-bottom: 10px; }
        .job-company { color: #666; font-size: 16px; margin-bottom: 8px; }
        .job-details { font-size: 14px; color: #888; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›ï¸ Firebase ì±„ìš©ì •ë³´ í…ŒìŠ¤íŠ¸</h1>
        
        <div id="status" class="status info">ì—°ê²° ì¤‘...</div>
        
        <div id="data-count" class="status info">ë°ì´í„° í™•ì¸ ì¤‘...</div>
        
        <div id="jobs-container"></div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, getDocs, limit, query } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        // Firebase ì„¤ì • - ì„ì‹œ í…ŒìŠ¤íŠ¸ìš©
        const firebaseConfig = {
            apiKey: "AIzaSyDvhF0qR3X8G7K5mNp9QwE2rT6yU1oI4sA", // í…ŒìŠ¤íŠ¸ìš© í‚¤
            authDomain: "job-pubint.firebaseapp.com",
            projectId: "job-pubint",
            storageBucket: "job-pubint.appspot.com",
            messagingSenderId: "738419891043",
            appId: "1:738419891043:web:4f5g6h7i8j9k0l1m2n3o4p5q"
        };

        const statusEl = document.getElementById('status');
        const countEl = document.getElementById('data-count');
        const jobsEl = document.getElementById('jobs-container');

        async function testFirebaseConnection() {
            try {
                // Firebase ì´ˆê¸°í™”
                console.log('Firebase ì´ˆê¸°í™” ì‹œì‘...');
                const app = initializeApp(firebaseConfig);
                const db = getFirestore(app);
                
                statusEl.textContent = 'âœ… Firebase ì´ˆê¸°í™” ì„±ê³µ';
                statusEl.className = 'status success';
                
                // ì»¬ë ‰ì…˜ì—ì„œ ë°ì´í„° ì½ê¸° ì‹œë„
                console.log('ë°ì´í„° ì½ê¸° ì‹œì‘...');
                const jobsRef = collection(db, 'recruitment_jobs');
                
                // ë‹¨ìˆœ ì¡°íšŒ (ì œí•œ ì—†ì´)
                const snapshot = await getDocs(jobsRef);
                
                console.log(`ì´ ${snapshot.size}ê°œ ë¬¸ì„œ ë°œê²¬`);
                countEl.textContent = `ğŸ“Š ì´ ${snapshot.size}ê°œ ì±„ìš©ê³µê³  ë°œê²¬`;
                countEl.className = 'status success';
                
                // ì²˜ìŒ 10ê°œë§Œ í‘œì‹œ
                let count = 0;
                snapshot.forEach((doc) => {
                    if (count < 10) {
                        const data = doc.data();
                        
                        const jobDiv = document.createElement('div');
                        jobDiv.className = 'job-item';
                        jobDiv.innerHTML = `
                            <div class="job-title">${data.recruit_title || 'ì œëª© ì—†ìŒ'}</div>
                            <div class="job-company">ğŸ¢ ${data.inst_nm || 'ê¸°ê´€ëª… ì—†ìŒ'}</div>
                            <div class="job-details">
                                ğŸ“ ${data.work_region || 'ì§€ì—­ ì •ë³´ ì—†ìŒ'} | 
                                ğŸ‘¥ ${data.recruit_person_cnt || 'ì¸ì› ë¯¸ì •'} |
                                ğŸ“… ${data.rcept_end_date || 'ê¸°í•œ ì—†ìŒ'}
                            </div>
                        `;
                        jobsEl.appendChild(jobDiv);
                        count++;
                    }
                });
                
                if (snapshot.size === 0) {
                    jobsEl.innerHTML = '<div class="status error">ì €ì¥ëœ ì±„ìš©ê³µê³ ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                }
                
            } catch (error) {
                console.error('Firebase ì˜¤ë¥˜:', error);
                statusEl.textContent = `âŒ ì—°ê²° ì‹¤íŒ¨: ${error.message}`;
                statusEl.className = 'status error';
                
                // ìƒì„¸ ì˜¤ë¥˜ ì •ë³´
                countEl.textContent = `ì˜¤ë¥˜ ì½”ë“œ: ${error.code || 'ì•Œ ìˆ˜ ì—†ìŒ'}`;
                countEl.className = 'status error';
                
                // ì¼ë°˜ì ì¸ Firebase ì˜¤ë¥˜ë“¤ì— ëŒ€í•œ ì•ˆë‚´
                let suggestion = '';
                if (error.code === 'permission-denied') {
                    suggestion = 'ğŸ’¡ Firebase ë³´ì•ˆ ê·œì¹™ì´ ì½ê¸°ë¥¼ ì°¨ë‹¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. Firestore ê·œì¹™ì„ í™•ì¸í•˜ì„¸ìš”.';
                } else if (error.code === 'not-found') {
                    suggestion = 'ğŸ’¡ ì»¬ë ‰ì…˜ì´ë‚˜ ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                } else if (error.code === 'invalid-api-key') {
                    suggestion = 'ğŸ’¡ API í‚¤ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. Firebase ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.';
                }
                
                if (suggestion) {
                    jobsEl.innerHTML = `<div class="status info">${suggestion}</div>`;
                }
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        testFirebaseConnection();
    </script>
</body>
</html>